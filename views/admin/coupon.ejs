<%-include('../layouts/admin-layout.ejs')%>

<section class="content-main">
  <div class="container">
    <div class="card">
      <div class="card-body">
    <h3>Add coupon</h3>
    <br />
    <form
      method="post"
      action="/admin/addcoupon"
    >
      <div class="form-group d-flex">
        <input
          type="text"
          class="form-control"
          id="generatecoupon"
          name="coupon"
          value=""
          style="background-color: white;border-color: white;"
        />
        <br />
        <button class="btn-success " style="color: white;border-color: white;border-width: 0px;height: fit-content;" onclick="generateCoupon()">Generate coupon</button>
      </div>
      <script>

      </script>
         

      <div class="form-group">
        <input
          type="text"
          class="form-control"
          id="exampleInputPassword1"
          name="description"
          placeholder="Enter Description"
          pattern="^(?=.*[a-zA-Z])(?!.*\d).+$"
          required
        />
      </div>

      <div class="form-group">
        <input
          type="date"
          class="form-control"
          id="exampleInputPassword1"
          name="date"
        />
      </div>

      <div class="form-group">
        <input
          type="number"
          class="form-control"
          id="exampleInputPassword1"
          name="discount"
          placeholder="discount%"
        />
      </div>

      
      <div class="form-group">
        <input
          type="number"
          class="form-control"
          id="exampleInputPassword1"
          name="min"
          placeholder="min.amount required for discount"
        />
      </div>

      <div class="form-group">
        <input
          type="number"
          class="form-control"
          id="exampleInputPassword1"
          name="max"
          placeholder="max.discount amount"
        />
      </div>

      <br />

      <button type="submit" class="btn btn-primary">Create Coupon</button>
      <div>
        <p style="color: red">
          <%=(typeof message!=='undefined' )?message:""%>
        </p>
        <script>
          setTimeout(function () {
            document.querySelector("p").innerHTML = "";
          }, 3000);
        </script>
      </div>
    </form>
      </div>
    </div>
  </div>
  
    <br />
   
    <!-- --------------DISPLAY CATEGORY----------------- -->

    <div class="card mb-4">
      <div class="card-body">
        <div class="table-responsive">
          <div class="table-responsive">
            <table class="table align-middle table-nowrap mb-0">
              <thead class="table-light">
                <tr>
                  <th class="align-middle" scope="col">coupon </th>
                  <th class="align-middle" scope="col">min.amt.req.purchase</th>
                  <th class="align-middle" scope="col">discount</th>
                  <th class="align-middle" scope="col">max.discount amount</th>

                  <th class="align-middle" scope="col">description</th>
                  <th class="align-middle" scope="col">created</th>
                  <th class="align-middle" scope="col">validity</th>
                  <th class="align-middle" scope="col">edit</th>


                 
                </tr>
              </thead>
              <tbody>
                <% couponlist.forEach((item) => { %>

             
              

                <tr>
                  <td> <%=item.couponCode%></td>
                  <td> <%=item.minpurchase%></td>
                  <td> <%=item.discount%></td>
                  <td> <%=item.maxdiscountvalue%></td>
                  <td> <%=item.description%></td>
                  <td><%= item.createdAt.toLocaleString() %></td>
                  <td><%= item.validity.toLocaleString() %></td>


                  <td> <a class="btn-primary" href="/admin/delete-coupon?code=<%=item.couponCode%>">Remove</a></td>



              
                </tr>
                <% }); %>
              </tbody>
            
            </table>
          </div>
        </div>
        <!-- table-responsive end// -->
      </div>
    </div>
  </div>
</section>

<%-include('../layouts/adminfooter.ejs')%>
